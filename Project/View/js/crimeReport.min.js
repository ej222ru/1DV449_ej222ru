"use strict";function renderPoliceReports(){function e(e,a,t,o){for(var l=0,r=0;t>r;r++)if(parseFloat(e[r].childNodes[0].nodeValue)==parseFloat(e[t].childNodes[0].nodeValue)&&parseFloat(a[r].childNodes[0].nodeValue)==parseFloat(a[t].childNodes[0].nodeValue)){l++;var s=parseFloat(e[t].childNodes[0].nodeValue)+.01*l,d=parseFloat(a[t].childNodes[0].nodeValue)+.01*l;o={lat:s,lng:d}}return o}var a=[];if(1==document.getElementById("policeReportsCheckBox").checked){if(localStorage.displayPoliceReports="Show",getPoliceReports(),void 0!=localStorage.policeReports){var t=jQuery.parseXML(localStorage.policeReports);if(t)for(var o=t.getElementsByTagName("lat"),l=t.getElementsByTagName("lng"),r=t.getElementsByTagName("description"),s=t.getElementsByTagName("place"),d=t.getElementsByTagName("text"),c=t.getElementsByTagName("event"),i=0;i<c.length;i++){var n=[],p={lat:parseFloat(o[i].childNodes[0].nodeValue),lng:parseFloat(l[i].childNodes[0].nodeValue)};p=e(o,l,i,p),n.pos=p,n.header=r[i].childNodes[0].nodeValue,n.descript=s[i].childNodes[0].nodeValue,n.text=d[i].childNodes[0].nodeValue,a.push(n)}for(var i=0;i<a.length;i++){var p=a[i].pos,g=a[i].header,m="<b>"+a[i].descript+"</br></b>"+a[i].text;addMarker(p,map,g,m,"policeReports")}}}else localStorage.displayPoliceReports="Hide",clearMarkers(),markRegionOnMap()}function attachCrimeCheckboxHandler(){var e=document.getElementById("crimeForm"),a=e.getElementsByTagName("input");"checkbox"===a[0].type&&(a[0].onclick=renderPoliceReports)}function getPoliceReports(){var e=new Date,a=e.getTime(),t=localStorage.getItem("lastDataRead"),o=a-t-6e4;if(null===localStorage.policeReports||null===t||o>0){console.log("read from brottsstatistik now:"+a+"---last read from brottsstatistik:"+t+"  diff:"+o);var l="&Crime=true";$.ajax({url:"index.php",type:"POST",async:!1,data:l,datatype:"text",success:function(e,t,o){localStorage.policeReports=e,localStorage.lastDataRead=a},error:function(e,a,t){}})}else console.log("read from cache   now:"+a+"---last read from brottsstatistik:"+localStorage.getItem("lastDataRead")+"  diff:"+o)}